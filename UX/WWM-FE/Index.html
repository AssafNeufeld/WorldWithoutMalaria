<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>WorldWithout Malaria - Real-Time Updating Malaria Threats</title>
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/handlebars-v4.0.10.js"></script>
    <script src="js/main.js"></script>

    <script>
         function initialize() {
             window.orgData = [
            {
            name: "Africa Fighting Malaria",
            method: "Pest control",
            activeCountries: "5",
            link: "http://www.fightingmalaria.org/"
            },
            {
            name: "AIDSfreeAFRICA",
            method: "Window and door screens made from recycled nets",
            activeCountries: "1",
            link: "http://aidsfreeafrica.org/our-programs/malaria-free-zone/"
            },
            {
            name: "Amref Health Africa",
            method: "Education; Builds health systems to treat patients ",
            activeCountries: "22",
            link: "http://www.amrefusa.org/"
            },
            {
            name: "Clinton Health Access Initiative",
            method: "Testing and medications",
            activeCountries: "22",
            link: "http://www.clintonhealthaccess.org/"
            },
            
            {
                name: "CURE International",
                method: "Opens and operates  pediatric charitable hospitals",
                activeCountries: "10",
                link: "https://cure.org/"
            },
                          
                {
                    name: "Global Health Council",
                    method: "Policy and Advocacy: Advocates US govt for increased visibility, leadership and investment in global health policy and budget priorities.",
                    activeCountries: "157",
                    link: "http://globalhealth.org/"
                },
                {
                    name: "Global Partners for Development",
                    method: "Medications",
                    activeCountries: "3",
                    link: "https://gpfd.org/"
                },
                {
                    name: "Medair",
                    method: "Emergency as well as year-round health clinics; medications, ",
                    activeCountries: "10",
                    link: "http://relief.medair.org/en/healing-communities/"
                },
                {
                    name: "Roll Back Malaria",
                    method: "Multisectoral Action Framework ",
                    activeCountries: "10",
                    link: "http://www.rollbackmalaria.org/"
                },

                {
                    name: "World Vision",
                    method: "Bed nets, indoor insecticide spraying",
                    activeCountries: "14",
                    link: "http://www.amrefusa.org/"
                },
                {
                    name: "Against Malaria Foundation",
                    method: "Bed nets",
                    activeCountries: "12",
                    link: "https://www.againstmalaria.com/"
                },
                            

             ];
             window.alertData = 
                 [{
                     "Country": "Ghana",
                     "Region": "Northern",
                     "Population": "2.87 M",
                     "Prediction": "30.44 %",
                     
                     "Medication": "Amref Health Africa", 
                     "Netting": "Against Malaria Foundation",
                     "Spraying": "World Vision"
                 },
{
    "Country": "Nigeria",
    "Region": "Kebbi",
    "Population": "5.19 M",
    "Prediction": "29.72 %",
    
    "Medication": "MedAid",
    "Netting": "Africa Fighting Malaria",
    "Spraying": "Roll Back Malaria"
},
{
    "Country": "Burkina Faso",
    "Region": "Sud-ouest",
    "Population": "1.48 M",
    "Prediction": "29.68 %",
    "Medication": "CURE International",
    "Netting": "Global Partners for Development",
    "Spraying": "Roll Back Malaria"
},
{
    "Country": "Guinea",
    "Region": "Kankan",
    "Population": "1.66 M",
    "Prediction": "29.52 %",
    
    "Medication": "MedAid",
    "Netting": "Global Partners for Development",
    "Spraying": "Roll Back Malaria"
},
{
    "Country": "Benin",
    "Region": "Alibori",
    "Population": "956.55 K",
    "Prediction": "29.22 %",
    "Medication": "CURE International",
    "Netting": "Africa Fighting Malaria",
    "Spraying": ""
},
{
    "Country": "Guinea",
    "Region": "Kindia",
    "Population": "1.66 M",
    "Prediction": "29.13 %",
    
    "Medication": "Amref Health Africa", 
    "Netting": "Against Malaria Foundation",
    "Spraying": "World Vision"
},
{
    "Country": "Burkina Faso",
    "Region": "Hauts-bassins",
    "Population": "1.48 M",
    "Prediction": "28.95 %",
    
    "Medication": "Amref Health Africa", 
    "Netting": "Against Malaria Foundation",
    "Spraying": "World Vision"
},
{
    "Country": "Mali",
    "Region": "Kayes",
    "Population": "2.08 M",
    "Prediction": "28.78 %"
},
{
    "Country": "Benin",
    "Region": "Atakora",
    "Population": "956.55 K",
    "Prediction": "28.72 %"
},
{
    "Country": "Burkina Faso",
    "Region": "Cascades",
    "Population": "1.48 M",
    "Prediction": "28.67 %"
},
{
    "Country": "Benin",
    "Region": "Donga",
    "Population": "956.55 K",
    "Prediction": "28.65 %"
},
{
    "Country": "Benin",
    "Region": "Borgou",
    "Population": "956.55 K",
    "Prediction": "28.52 %"
},
{
    "Country": "Burkina Faso",
    "Region": "Boucle Du Mouhoun",
    "Population": "1.48 M",
    "Prediction": "28.52 %"
},
{
    "Country": "Togo",
    "Region": "Centrale",
    "Population": "1.54 M",
    "Prediction": "28.31 %"
},
{
    "Country": "Nigeria",
    "Region": "Adamawa",
    "Population": "5.19 M",
    "Prediction": "28.29 %"
},
{
    "Country": "Burkina Faso",
    "Region": "Est",
    "Population": "1.48 M",
    "Prediction": "28.22 %"
},
{
    "Country": "Burkina Faso",
    "Region": "Centre-sud",
    "Population": "1.48 M",
    "Prediction": "28.17 %"
},
{
    "Country": "Burkina Faso",
    "Region": "Centre-ouest",
    "Population": "1.48 M",
    "Prediction": "28.13 %"
},
{
    "Country": "Ghana",
    "Region": "Brong Ahafo",
    "Population": "2.87 M",
    "Prediction": "28.09 %"
},
{
    "Country": "Mali",
    "Region": "Sikasso",
    "Population": "2.08 M",
    "Prediction": "28.04 %"
},
{
    "Country": "Nigeria",
    "Region": "Kwara",
    "Population": "5.19 M",
    "Prediction": "27.82 %"
},
{
    "Country": "Burkina Faso",
    "Region": "Centre-nord",
    "Population": "1.48 M",
    "Prediction": "27.57 %"
},
{
    "Country": "Niger",
    "Region": "Dosso",
    "Population": "2.70 M",
    "Prediction": "27.39 %"
},
{
    "Country": "Burkina Faso",
    "Region": "Plateau Central",
    "Population": "1.48 M",
    "Prediction": "27.29 %"
},
{
    "Country": "Togo",
    "Region": "Kara",
    "Population": "1.54 M",
    "Prediction": "27.24 %"
},
{
    "Country": "Guinea",
    "Region": "Labe",
    "Population": "1.66 M",
    "Prediction": "27.13 %",
    "Medication": "Global Partners for Development",
    "Netting": "",
    "Spraying": ""
},
{
    "Country": "Mali",
    "Region": "Mopti",
    "Population": "2.08 M",
    "Prediction": "27.07 %",
    "Medication": "Global Partners for Development",
    "Netting": "",
    "Spraying": ""
},
{
    "Country": "Burkina Faso",
    "Region": "Nord",
    "Population": "1.48 M",
    "Prediction": "26.93 %",
    "Medication": "Global Partners for Development",
    "Netting": "",
    "Spraying": ""
},
{
    "Country": "Democratic Republic of the Congo",
    "Region": "Province Orientale",
    "Population": "7.49 M",
    "Prediction": "26.73 %"
},
{
    "Country": "Togo",
    "Region": "Plateaux",
    "Population": "1.54 M",
    "Prediction": "26.38 %"
} ];
            var alertTemplateScript = $("#alert-template").html();
            var alertTemplate = Handlebars.compile(alertTemplateScript);
            $(".alertNav").append(alertTemplate(window.alertData));

            var orgTemplateScript = $("#org-template").html();
            var orgTemplate = Handlebars.compile(orgTemplateScript);
            $(".orgNav").append(orgTemplate(window.orgData));

        }
    </script>

    <script id="org-template" type="x-handlebars-template">
        <ul class="flex-container">
            {{#each this}}
            <li class="flex-item">
                <div class="panel panel-default org">
                    <div class="panel-heading"><b>{{name}}</b></div>
                    <div class="panel-body">
                        <ul class="list-group">
                            <li class="list-group-item">{{method}}</li>
                            <li class="list-group-item">{{activeCountries}} Active countries</li>
                            <li class="list-group-item"><a href="{{link}}">{{link}}</a></li>
                        </ul>
                    </div>
                </div>
            </li>
            {{/each}}
        </ul>
    </script>

    <script id="alert-template" type="x-handlebars-template">
        {{#each this}}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h2 class="panel-title">{{Region}}, {{Country}}</h2>
            </div>
            <div class="panel-body">
                <div>
                    <ul class="flex-container">
                        <li class="flex-item alert-flex">
                            <div class="alert-number">{{Prediction}}</div>
                            <h4 class="alert-content">Probability of Malaria outbreak within next 6 months</h4>
                        </li>
                        <li class="flex-item alert-flex">
                            <div class="alert-number">
                                <span class="glyphicon glyphicon-user" aria-hidden="true"></span> {{Population}}
                            </div>
                            <h4 class="alert-content">People immediately at-risk</h4>
                        </li>
                    </ul>
                </div>
                <hr>
                <div>
                    <ul class="flex-container">
                        <li class="flex-item">
                            <h4><img src="images/Medicine.png" class="org-image"/> {{Medication}}</h4>
                        </li>
                        <li class="flex-item">
                            <h4><img src="images/Spraying.png" class="org-image"/> {{Spraying}}</h4>
                        </li>
                        <li class="flex-item">
                            <h4><img src="images/Netting.png" class="org-image"/> {{Netting}}</h4>
                        </li>
                    </ul>
                </div>
             </div>
        </div>
        {{/each}}
    </script>

    <link rel="stylesheet" href="css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/main.css">

    <meta charset="utf-8" />
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {
            'packages':['geochart'],
            // Note: you will need to get a mapsApiKey for your project.
            // See: https://developers.google.com/chart/interactive/docs/basic_load_libs#load-settings
            'mapsApiKey': 'AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY'
        });
        google.charts.setOnLoadCallback(drawRegionsMap);


        function drawRegionsMap() {
            datatable = [];
            datatable.push(['Area', 'Calculated model risk:'])
            window.alertData.forEach(function(alert){
                datatable.push([alert.Country, parseInt(alert.Prediction.split('.')[0])])
            });
            console.log(datatable);

            var data = google.visualization.arrayToDataTable(datatable);

            var options = {
                region: '002', // Africa
                resolution: 'cities',
                width: 1500,
                height: 800,
                colorAxis: {colors: ['#ff9999', '#ff0000']} // orange to blue
            };

            var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));

            chart.draw(data, options);
        }
    </script>
</head>
<body onload="initialize()">
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
        <div class="container-fluid navbar-custom">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">World Without Malaria</a>
            </div>
            <ul class="nav navbar-nav">
                <li class="active"><a href="#tab1" data-toggle="tab">Home</a></li>
                <li><a href="#tab2" data-toggle="tab">Live Risk Map</a></li>
                <li><a href="#tab3" data-toggle="tab">Available Resources</a></li>
                <li><a href="#tab4" data-toggle="tab">About</a></li>
            </ul>
        </div>
    </nav>

    
    <div class="tab-content">

        <div class="tab-pane fade in active" id="tab1">
            <div class="jumbotron jumbo">
                <h1>World Without Malaria</h1>
                <p>World Without Malaria is a project from Microsoft that aims to save lives in Malaria stricken areas.</p> 
                <p>We use real-time and historic climate data collected by the NASA MERRA-2 project, and analyze it using Machine-Learning to predict upcoming Malaria outbreaks. Early prediction and treatment is a critical factor in eliminating Malaria world-wide. </p>
                <p>We've analyzed over 5 Terra of data and counting, and produce a real-time, updating Malaria threat assesment.</p>
            </div>
            <div class="risk-feed">
                <h2 class="risk-feed-title">Real-Time Global Risk Assesment</h2>
                <div class="alertNav"></div>
            </div>
        </div>

        <div class="tab-pane fade" id="tab2">
            <div id="regions_div"></div>
        </div>

        <div class="tab-pane fade" id="tab3">
            <div class="orgNav"></div>
        </div>

        <div class="tab-pane fade" id="tab4">
            <img src="images/team.png" class="img-rounded" alt="World Without Malaria Team" height="600" width="600">
            <p>We're a team working for the Microsoft 2017 hackathon.</p>
            <p>Malaria is a life-threatening disease transmitted to people through the bites of infected mosquitoes. An estimated 730,000 people die from Malaria each year, with children under 5 especially susceptible. It is PREVENTABLE and TREATABLE with the right tools.</p>
            <p>One of the biggest challenges in treating Malaria and other vector-borne diseases is administering the right treatment, on-time, when a new outbreak occurs.</p>
            <p>This project aims to use publicly available data about historical outbreaks, and spatially correlate it with sensory observation data from NASA, to try to predict the next dangerous Malaria hot-spot.</p>
            <p>Data sources:</p>
            <p>NASA Earth observation data - https://disc.gsfc.nasa.gov/ </p>
            <br/>
            <p>Contact us at assafn (at) microsoft.com</p>                        
        </div>
    </div>
</body>
</html>
