<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>WorldWithout Malaria - Real-Time Updating Malaria Threats</title>
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/handlebars-v4.0.10.js"></script>
    <script src="js/main.js"></script>

    <script>
         function initialize() {
             window.orgData = [
            {
            name: "Africa Fighting Malaria",
            method: "Pest control",
            activeCountries: "5",
            link: "http://www.fightingmalaria.org/"
            },
            {
            name: "AIDSfreeAFRICA",
            method: "Window and door screens made from recycled nets",
            activeCountries: "1",
            link: "http://aidsfreeafrica.org/our-programs/malaria-free-zone/"
            },
            {
            name: "Amref Health Africa",
            method: "Education; Builds health systems to treat patients ",
            activeCountries: "22",
            link: "http://www.amrefusa.org/"
            },
            {
            name: "Clinton Health Access Initiative",
            method: "Testing and medications",
            activeCountries: "22",
            link: "http://www.clintonhealthaccess.org/"
            },
            
                        {
                            name: "CURE International",
                            method: "Opens and operates  pediatric charitable hospitals",
                            activeCountries: "10",
                            link: "https://cure.org/"
                        },
                          
                          {
                              name: "Global Health Council",
                              method: "Policy and Advocacy: Advocates US govt for increased visibility, leadership and investment in global health policy and budget priorities.",
                              activeCountries: "157",
                              link: "http://globalhealth.org/"
                          },
                          {
                              name: "Global Partners for Development",
                              method: "Medications",
                              activeCountries: "3",
                              link: "https://gpfd.org/"
                          },
                          {
                              name: "Medair",
                              method: "Emergency as well as year-round health clinics; medications, ",
                              activeCountries: "10",
                              link: "http://relief.medair.org/en/healing-communities/"
                          },
                          {
                              name: "Roll Back Malaria",
                              method: "Multisectoral Action Framework ",
                              activeCountries: "10",
                              link: "http://www.rollbackmalaria.org/"
                          },

                           {
                               name: "World Vision",
                               method: "Bed nets, indoor insecticide spraying",
                               activeCountries: "14",
                               link: "http://www.amrefusa.org/"
                           },
                            {
                                name: "Against Malaria Foundation",
                                method: "Bed nets",
                                activeCountries: "12",
                                link: "https://www.againstmalaria.com/"
                            },
                            

             ];
            window.alertData = [
                  {
                      "Country": "Osire, Namibia",
                      "Percent": "52%",
                      "Affected": "350k",
                      "Lon": -21.068692,
                      "Lat": 17.363,
                  },
                  {
                      "Country": "Kanyama, Congo",
                      "Percent": "22%",
                      "Affected": "100k",
                      "Lon": -7.5,
                      "Lat": 24.179,
                  },
                   {
                       "Country": "Mali",
                       "Percent": "10%",
                       "Affected": "20k",
                       "Lon": -21.068692,
                       "Lat": 13.363,
                   },
                    {
                        "Country": "Mali",
                        "Percent": "5%",
                        "Affected": "23k",
                        "Lon": -11.068692,
                        "Lat": 27.363,
                    }
            ];
            var alertTemplateScript = $("#alert-template").html();
            var alertTemplate = Handlebars.compile(alertTemplateScript);
            $(".alertNav").append(alertTemplate(window.alertData));

            var orgTemplateScript = $("#org-template").html();
            var orgTemplate = Handlebars.compile(orgTemplateScript);
            $(".orgNav").append(orgTemplate(window.orgData));

        }
    </script>

    <script id="org-template" type="x-handlebars-template">
        <ul class="flex-container">
            {{#each this}}
            <li class="flex-item">
                <div class="panel panel-default org">
                    <div class="panel-heading"><b>{{name}}</b></div>
                    <div class="panel-body">
                        <ul class="list-group">
                            <li class="list-group-item">{{method}}</li>
                            <li class="list-group-item">{{activeCountries}} Active countries</li>
                            <li class="list-group-item"><a href="{{link}}">{{link}}</a></li>
                        </ul>
                    </div>
                </div>
            </li>
            {{/each}}
        </ul>
    </script>

    <script id="alert-template" type="x-handlebars-template">
        {{#each this}}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h2 class="panel-title">{{Country}}</h2>
            </div>
            <div class="panel-body">
                <ul class="flex-container">
                    <li class="flex-item">
                        <div class="alert-number">{{Percent}}</div>
                        <div class="alert-content">Probability of Malaria outbreak within 2 weeks</div>
                    </li>
                    <li class="flex-item">
                        <div class="alert-number">
                            <span class="glyphicon glyphicon-user" aria-hidden="true"></span> {{Affected}}
                        </div>
                        <div class="alert-content">People immediately at-risk</div>
                    </li>
                </ul>
            </div>
        </div>
        {{/each}}
    </script>

    <link rel="stylesheet" href="css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/main.css">

    <meta charset="utf-8" />
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {
            'packages':['geochart'],
            // Note: you will need to get a mapsApiKey for your project.
            // See: https://developers.google.com/chart/interactive/docs/basic_load_libs#load-settings
            'mapsApiKey': 'AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY'
        });
        google.charts.setOnLoadCallback(drawRegionsMap);


        function drawRegionsMap() {
            datatable = [];
            datatable.push(['Area', 'Risk Percentage'])
            window.alertData.forEach(function(alert){
                datatable.push([alert.Country, parseInt(alert.Percent.split('%')[0])])
            });
            console.log(datatable);

            var data = google.visualization.arrayToDataTable(datatable);

            var options = {
                region: '002', // Africa
                resolution: 'cities',
                width: 1500,
                height: 800,
                colorAxis: {colors: ['#ff9999', '#ff0000']} // orange to blue
            };

            var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));

            chart.draw(data, options);
        }
    </script>
</head>
<body onload="initialize()">
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
        <div class="container-fluid navbar-custom">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">World Without Malaria</a>
            </div>
            <ul class="nav navbar-nav">
                <li class="active"><a href="#tab1" data-toggle="tab">Areas At-Risk</a></li>
                <li><a href="#tab2" data-toggle="tab">Live Risk Map</a></li>
                <li><a href="#tab3" data-toggle="tab">Available Resources</a></li>
                <li><a href="#tab4" data-toggle="tab">About</a></li>
            </ul>
        </div>
    </nav>

    
    <div class="tab-content">

        <div class="tab-pane fade in active" id="tab1">
            <div class="jumbotron jumbo">
                <h1>World Without Malaria</h1>
                <p>World Without Malaria is a project from Microsoft that aims to save lives in Malaria stricken areas.<br /> We use NASA data collected by the MERRA-2 project, and correlate it using Machine-Learning to predict upcoming Malaria outbreaks. Early prediction and treatment is a key factor in eliminating Malaria world-wide. </p>
            </div>
            <div class="risk-feed">
                <h2 class="risk-feed-title">Real-Time Global Risk Assesment</h2>
                <div class="alertNav"></div>
            </div>
        </div>

        <div class="tab-pane fade" id="tab2">
            <div id="regions_div" style="width: 1300px; height: 1000px;"></div>
        </div>

        <div class="tab-pane fade" id="tab3">
            <div class="orgNav"></div>
        </div>

        <div class="tab-pane fade" id="tab4">
            <div class="row">
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail">
                        <img src="images/team.png" alt="World Without Malaria Team">
                        <div class="caption">
                            <h3>World Without Malaria Team</h3>
                            <p>We're a team working for the Microsoft 2017 hackathon.</p>
                            <p>Contact us at assafn (at) microsoft.com</p>
                        </div>
                    </div>
                </div>
            </div>
                <h1></h1>
                <p></p>
            
        </div>

    </div>
      


</body>
</html>
