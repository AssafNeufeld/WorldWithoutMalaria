<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>WorldWithout Malaria - Real-Time Updating Malaria Threats</title>
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/handlebars-v4.0.10.js"></script>
    <script src="js/main.js"></script>
    <script>
         function initialize() {

            window.alertData = [
                  {
                      "Country": "Osire, Namibia",
                      "Percent": "52%",
                      "Affected": "350k",
                      "Lon": -21.068692,
                      "Lat": 17.363,
                  },
                  {
                      "Country": "Kanyama, Congo",
                      "Percent": "22%",
                      "Affected": "100k",
                      "Lon": -7.5,
                      "Lat": 24.179,
                  },
                   {
                       "Country": "Djibuti, Mali",
                       "Percent": "10%",
                       "Affected": "20k",
                       "Lon": -21.068692,
                       "Lat": 13.363,
                   },
                    {
                        "Country": "Moz, Mali",
                        "Percent": "5%",
                        "Affected": "23k",
                        "Lon": -11.068692,
                        "Lat": 27.363,
                    }
            ];

            var theTemplateScript = $("#alert-template").html();
            var theTemplate = Handlebars.compile(theTemplateScript);
            $(".alertNav").append(theTemplate(window.alertData));
        }
    </script>

    <script id="alert-template" type="x-handlebars-template">
        {{#each this}}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h2 class="panel-title">{{Country}}</h2>
            </div>
            <div class="panel-body">
                <ul class="flex-container">
                    <li class="flex-item">
                        <div class="alert-number">{{Percent}}</div>
                        <div class="alert-content">Probability of Malaria outbreak within 2 weeks</div>
                    </li>
                    <li class="flex-item">
                        <div class="alert-number">
                            <span class="glyphicon glyphicon-user" aria-hidden="true"></span> {{Affected}}
                        </div>
                        <div class="alert-content">People immediately at-risk</div>
                    </li>
                    <li class="flex-item">
                        <!-- Single button -->
                        <div class="btn-group">
                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                How to help? <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li><a href="#">Donate</a></li>
                                <li><a href="#">Raise Awareness</a></li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        {{/each}}

    </script>
    
    <link rel="stylesheet" href="css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/main.css">

    <meta charset="utf-8" />
</head>
<body onload="initialize()">


    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">World Without Malaria</a>
            </div>
            <ul class="nav navbar-nav">
                <li class="active"><a href="#tab1" data-toggle="tab">Areas At-Risk</a></li>
                <li><a href="#tab2" data-toggle="tab">Map</a></li>
                <li><a href="#tab3" data-toggle="tab">Links</a></li>
            </ul>
        </div>
    </nav>

    <div class="panel-heading">
        <div class="panel-body">
            <div class="tab-content">
                <div class="tab-pane fade in active alertNav" id="tab1"></div>                 <div class="tab-pane fade" id="tab2">
                     <div id="map"></div>
                     <script>
                        
                        function initMap() {
                            var map = new google.maps.Map(document.getElementById('map'), {
                                zoom: 3,
                                center: {lat: 8.7, lng: 19.2}
                            });

                            // Create an array of alphabetical characters used to label the markers.
                            var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

                            // Add some markers to the map.
                            // Note: The code uses the JavaScript Array.prototype.map() method to
                            // create an array of markers based on a given "locations" array.
                            // The map() method here has nothing to do with the Google Maps API.
                            var markers = window.alertData.map(function(alert, i) {
                                var location = {lat: alert.Lat, lon: alert.Lon};
                                return new google.maps.Marker({
                                position: location,
                                label: alert.Country
                                });
                        });

                        // Add a marker clusterer to manage the markers.
                        var markerCluster = new MarkerClusterer(map, markers,
                            {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
                        }
                                  
                        </script>
                        <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
                        </script>
                        <script async defer
                                src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA6HhPsViByj_rBLwrPCVhfVqBkEiLb2No&callback=initMap">
                        </script>
                    <div class="tab-pane fade" id="tab3"></div>
                </div>
            </div>
        </div>
    </div>


</body>
</html>
